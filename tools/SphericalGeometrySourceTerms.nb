(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13315,        395]
NotebookOptionsPosition[     11946,        365]
NotebookOutlinePosition[     12304,        381]
CellTagsIndexPosition[     12261,        378]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
These are equations A8 and A9 in Zhang & MacFadyen (2006), integrated over \
the cell volume.\
\>", "Subtitle",
 CellChangeTimes->{{3.849869436841304*^9, 3.8498694648732233`*^9}, {
  3.849869589229004*^9, 3.849869617800227*^9}, {3.849869751244782*^9, 
  3.849869752099588*^9}},ExpressionUUID->"9ee2e050-47b8-410f-b2cf-\
ee5b96e3a037"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a8", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"2", "p"}], "+", 
     RowBox[{"\[Rho]", " ", "h", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["u\[Theta]", "2"], "+", 
        SuperscriptBox["u\[Phi]", "2"]}], ")"}]}]}], "r"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a9", "=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"Cot", "[", "\[Theta]", "]"}], "p"}], "+", 
     RowBox[{"\[Rho]", " ", "h", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["u\[Phi]", "2"], 
         RowBox[{"Cot", "[", "\[Theta]", "]"}]}], "-", 
        RowBox[{"ur", " ", "u\[Theta]"}]}], ")"}]}]}], "r"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a10", "=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[Rho]", " ", "h", " ", "u\[Phi]", 
      RowBox[{"(", 
       RowBox[{"ur", "+", 
        RowBox[{"u\[Theta]", " ", 
         RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], ")"}]}], "r"]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.84986949142083*^9, 3.8498695392219543`*^9}, {
  3.8820062326938868`*^9, 3.8820062939920607`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"438637f0-a806-41c0-b3df-803a2c31ea36"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vol", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"2", 
     StyleBox["\[Pi]",
      FontSize->14], 
     StyleBox[" ",
      FontSize->14], 
     SuperscriptBox["r", "2"], 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Theta]0", ",", "\[Theta]1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"srdot", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"a8", 
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]", " ", 
       SuperscriptBox["r", "2"], 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Theta]0", ",", "\[Theta]1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sqdot", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"a9", 
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]", " ", 
       SuperscriptBox["r", "2"], 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Theta]0", ",", "\[Theta]1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"vol", "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"srdot", "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"sqdot", "//", "Simplify"}]}], "Input",
 CellChangeTimes->{
  3.882006310753269*^9, {3.882006356773225*^9, 3.8820063593263397`*^9}, {
   3.8820063920959387`*^9, 3.8820064004540157`*^9}, {3.882006579707013*^9, 
   3.882006594601138*^9}, {3.882007020625821*^9, 3.8820070274877653`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"91d6174b-f0be-42cd-835d-6a8251741201"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["2", "3"]}], " ", "\[Pi]", " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["r0", "3"], "-", 
    SuperscriptBox["r1", "3"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]0", "]"}], "-", 
    RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.88200659511738*^9, {3.8820070220968733`*^9, 3.88200702818225*^9}},
 CellLabel->"Out[54]=",ExpressionUUID->"98c8d2bf-1173-4ebd-b4b8-2426a4492c21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[Pi]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["r0", "2"], "-", 
    SuperscriptBox["r1", "2"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "p"}], "+", 
    RowBox[{"h", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["u\[Theta]", "2"], "+", 
       SuperscriptBox["u\[Phi]", "2"]}], ")"}], " ", "\[Rho]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]0", "]"}], "-", 
    RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.88200659511738*^9, {3.8820070220968733`*^9, 3.882007028733972*^9}},
 CellLabel->"Out[55]=",ExpressionUUID->"fd9fbddd-34c4-4755-b527-5e79f7e47100"],

Cell[BoxData[
 RowBox[{"\[Pi]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["r0", "2"]}], "+", 
    SuperscriptBox["r1", "2"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "h"}], " ", "ur", " ", "u\[Theta]", " ", "\[Rho]", " ", 
     RowBox[{"Cos", "[", "\[Theta]0", "]"}]}], "+", 
    RowBox[{"h", " ", "ur", " ", "u\[Theta]", " ", "\[Rho]", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "+", 
       RowBox[{"h", " ", 
        SuperscriptBox["u\[Phi]", "2"], " ", "\[Rho]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]0", "]"}], "-", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ")"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.88200659511738*^9, {3.8820070220968733`*^9, 3.882007029294096*^9}},
 CellLabel->"Out[56]=",ExpressionUUID->"0d9cb589-db67-45db-9d3a-3bc0a369c265"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vol", ":=", 
  RowBox[{"Integrate", "[", 
   StyleBox[" ",
    FontSize->14], 
   RowBox[{
    RowBox[{
     SuperscriptBox["r", "2"], 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Theta]0", ",", "\[Theta]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Phi]0", ",", "\[Phi]1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"srdot", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"a8", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Theta]0", ",", "\[Theta]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Phi]0", ",", "\[Phi]1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sqdot", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"a9", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Theta]0", ",", "\[Theta]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Phi]0", ",", "\[Phi]1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"s\[Phi]dot", ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"a10", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Theta]0", ",", "\[Theta]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Phi]0", ",", "\[Phi]1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"vol", "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"srdot", "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"sqdot", "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"s\[Phi]dot", "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.882006605400794*^9, 3.882006652793208*^9}, {
  3.882007011322898*^9, 3.88200703194275*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"18426a91-4ffa-4cab-9879-11556a195cd1"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "3"], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["r0", "3"], "-", 
    SuperscriptBox["r1", "3"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]0", "]"}], "-", 
    RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.882006659875589*^9, {3.882007012828081*^9, 3.8820070328812447`*^9}},
 CellLabel->"Out[61]=",ExpressionUUID->"5855d4a6-2002-4e3d-8ab5-4c89889241f7"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["r0", "2"], "-", 
    SuperscriptBox["r1", "2"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "p"}], "+", 
    RowBox[{"h", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["u\[Theta]", "2"], "+", 
       SuperscriptBox["u\[Phi]", "2"]}], ")"}], " ", "\[Rho]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]0", "]"}], "-", 
    RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.882006659875589*^9, {3.882007012828081*^9, 3.882007034009533*^9}},
 CellLabel->"Out[62]=",ExpressionUUID->"bd4d3f3e-6fee-435f-9e5b-5a5577034e9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["r0", "2"]}], "+", 
    SuperscriptBox["r1", "2"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}], " ", 
  RowBox[{"Sin", "[", 
   FractionBox[
    RowBox[{"\[Theta]0", "-", "\[Theta]1"}], "2"], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "+", 
       RowBox[{"h", " ", 
        SuperscriptBox["u\[Phi]", "2"], " ", "\[Rho]"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"\[Theta]0", "+", "\[Theta]1"}], "2"], "]"}]}], "-", 
    RowBox[{"h", " ", "ur", " ", "u\[Theta]", " ", "\[Rho]", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"\[Theta]0", "+", "\[Theta]1"}], "2"], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.882006659875589*^9, {3.882007012828081*^9, 3.8820070352429934`*^9}},
 CellLabel->"Out[63]=",ExpressionUUID->"e3e03e46-db73-4755-b8d2-4997b0b3854a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", "h", " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["r0", "2"], "-", 
    SuperscriptBox["r1", "2"]}], ")"}], " ", "u\[Phi]", " ", "\[Rho]", " ", 
  RowBox[{"(", 
   RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ur", " ", 
     RowBox[{"Cos", "[", "\[Theta]0", "]"}]}], "-", 
    RowBox[{"ur", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{"u\[Theta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Theta]0", "]"}]}], "+", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ")"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.882006659875589*^9, {3.882007012828081*^9, 3.882007036020327*^9}},
 CellLabel->"Out[64]=",ExpressionUUID->"9bd4acc1-cdd9-407e-aef7-72f6e71981fb"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1352, 1545},
WindowMargins->{{Automatic, 123}, {Automatic, 0}},
Magnification->2.,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 344, 7, 170, "Subtitle",ExpressionUUID->"9ee2e050-47b8-410f-b2cf-ee5b96e3a037"],
Cell[927, 31, 1223, 38, 263, "Input",ExpressionUUID->"438637f0-a806-41c0-b3df-803a2c31ea36"],
Cell[CellGroupData[{
Cell[2175, 73, 1831, 49, 280, "Input",ExpressionUUID->"91d6174b-f0be-42cd-835d-6a8251741201"],
Cell[4009, 124, 512, 14, 111, "Output",ExpressionUUID->"98c8d2bf-1173-4ebd-b4b8-2426a4492c21"],
Cell[4524, 140, 728, 21, 95, "Output",ExpressionUUID->"fd9fbddd-34c4-4755-b527-5e79f7e47100"],
Cell[5255, 163, 953, 26, 141, "Output",ExpressionUUID->"0d9cb589-db67-45db-9d3a-3bc0a369c265"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6245, 194, 2449, 67, 367, "Input",ExpressionUUID->"18426a91-4ffa-4cab-9879-11556a195cd1"],
Cell[8697, 263, 550, 15, 111, "Output",ExpressionUUID->"5855d4a6-2002-4e3d-8ab5-4c89889241f7"],
Cell[9250, 280, 795, 23, 110, "Output",ExpressionUUID->"bd4d3f3e-6fee-435f-9e5b-5a5577034e9e"],
Cell[10048, 305, 997, 29, 173, "Output",ExpressionUUID->"e3e03e46-db73-4755-b8d2-4997b0b3854a"],
Cell[11048, 336, 870, 25, 110, "Output",ExpressionUUID->"9bd4acc1-cdd9-407e-aef7-72f6e71981fb"]
}, Open  ]]
}, Open  ]]
}
]
*)

